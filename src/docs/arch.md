# 📁 Архитектура проекта (MFSD)
## 🧩 Вводная
> MFSD (Modular Feature-Sliced Design) — это архитектурный подход, сочетающий в себе преимущества:
> * Feature-Sliced Design (FSD): систематическое разбиение фронтенд-приложения на смысловые слои;
> * Modular Architecture: модульность как единица изоляции и масштабируемости;
> * Rich Components: принцип, при котором компонент инкапсулирует как UI, так и поведение, не дробясь на избыточные атомы.
> 
> MFSD фокусируется на масштабируемости, читаемости и независимости фичей и модулей, что особенно важно в распределённых командах, enterprise-средах и при долгосрочной поддержке продукта.



## 🧱 Базовые принципы
> 1. Feature-Sliced Design (FSD) Делит фронтенд-приложение на семантические слои (shared, entities, features, widgets, pages). Каждый слой выполняет конкретную роль и не имеет обратных зависимостей.
>
> 2. Modular Architecture Дополняет FSD уровнем modules/, который служит контейнером бизнес-направлений. Модуль — это не просто страница, а контекст (domain) со своими хуками, фичами, UI, состоянием и логикой.
>    
> 3. Rich Components Pattern Отказ от избыточной атомизации UI в пользу компонентного подхода, где один компонент может включать в себя и представление, и обработку состояний, и побочные эффекты.

## 📂 Структура проекта
```
src/
├── shared/             # 🔁 Общие, переиспользуемые ресурсы (всегда независимы от бизнес-контекста)
├── modules/            # 📦 Бизнес-модули (логически и технически обособленные части приложения)
├── components/         # 🧩 Универсальные визуальные компоненты UI, независимые от бизнес-смыслов
└── app/                # 🌐 Next.js routing, layout'ы страниц, entry-файлы
```

### 🔁 shared/ — Переиспользуемая "библиотека проекта"
#### Назначение:
> Содержит общие вспомогательные абстракции, используемые во всём проекте. Этот слой не имеет бизнес-смысла, не зависит от modules/ и служит основой для всех слоёв.
####Структура:
```
shared/
├── lib/                # Вспомогательные библиотеки, обёртки над внешними API, custom-client'ы
├── utils/              # Утилиты (например, `formatDate`, `toSlug`, `groupBy`, `debounce`)
├── hooks/              # Общие хуки (например, `useWindowSize`, `useCopyToClipboard`)
│   └── api/            # Специализированные хуки для работы с API (на базе TanStack Query)
├── types/              # Глобальные TypeScript типы и схемы Zod (например, `User`, `Wallet`)
└── mock/               # Фейковые данные, заглушки API, функции имитации
```
#### Правила:
> Хуки, утилиты и типы не должны знать о модулях.
> Всё в shared/ может быть использовано в любом месте, в том числе внутри modules/.



### 📦 modules/ — Бизнес-модули (domain-oriented grouping)
#### Назначение:
> Представляют собой контейнеры бизнес-направлений — например, "Профиль", "Финансы", "Партнёрка". Модули изолируют логику и UI конкретного направления. Это ядро масштабируемости.
>
> Модуль — это не только страница, а набор логически связанных фичей и сущностей.
 
#### Структура:
```
modules/
└── partner-balance/
    ├── module.tsx            # Точка входа: может экспортировать layout, страницу или флоу
    ├── slices/               # Элементарные UI-компоненты (кнопки, блоки, текстовые рендеры)
    ├── entities/             # Представление бизнес-сущностей (например, "баланс", "кошелёк")
    ├── features/             # Фичи, в которых реализовано поведение, side-эффекты, формы и т.п.
    ├── hooks/                # Специфическая для модуля логика
    │   └── api/              # useQuery/useMutation над API, заточенные под данный модуль
    └── exports/              # Ленивые динамические импорты (через `next/dynamic`)
```
#### Пояснение к поддиректориям:
> * slices/ — UI-единицы модуля без логики (BalanceValue, CurrencyLabel)
> * entities/ — Бизнес-сущности и их визуальные представления (WalletCard, TransactionList)
> * features/ — Самостоятельные интерактивные блоки (SendMoneyForm, TopUpAction)
> * hooks/ — Поведенческая логика: useBalanceFilters, useTopUpFlow
> * exports/ — Упрощает SSR, оптимизирует загрузку

### 🧩 components/ — Универсальные UI-блоки
#### Назначение:
> Содержит независимые от бизнес-логики компоненты, доступные всем слоям. Это визуальный toolkit проекта.
#### Структура:
```
components/
├── slices/             # Мелкие переиспользуемые части UI (иконки, кнопки, блоки без логики)
├── features/           # Универсальные фичи, включающие взаимодействие, API, хуки
├── flows/              # Сложные агрегаторы UI/UX, координирующие несколько компонентов
├── layouts/            # Layout-компоненты: каркасы страниц, responsive обёртки
└── providers/          # App-level провайдеры: QueryClientProvider, ThemeProvider и др.
```
#### Пояснение к поддиректориям
> *slices/ — "атомарные" элементы дизайна системы
> 
>   Пример: MobileSheet, SectionTitle, SocialLinks

> * features/ — Фичи общего назначения
>   
>   Пример: ConnectWalletButton, ThemeSwitcher, LanguageSelector

> * flows/ Компоненты, выросшие из slices, агрегируют UI и поведение. UI-флоу, объединяющий features и slices
>   
>   Пример: HeaderFlow, PartnerActionsFlow, ProfileFlow

> * layouts/ Составные layout-компоненты, определяющие расположение и каркас.
>
>   Пример: DesktopLayout, MobileLayout, PageLayout

> * providers/ — Контексты и провайдеры приложения
>
>   Пример: ToasterProvider, I18nProvider


### 📤 exports/ — Ленивая загрузка компонентов
#### Назначение:
> Раздел, предназначенный для динамической загрузки компонентов через next/dynamic или React.lazy.
#### Пример:
```tsx
// widgets/exports/LazyMobileSheet.tsx
export const LazyMobileSheet = dynamic(() => import('../slices/MobileSheet'), {
  ssr: false,
})
```

### 📌 Визуальная аналогия архитектуры
> ```
> shared/      → "Toolbox" проекта (утилиты, хуки, типы)
> modules/     → "Приложения" внутри системы (страницы, направления)
> components/  → "Конструктор интерфейса" (визуальные детали)
> app/         → "Входная точка" + роутинг и глобальный layout
> ```

### 🔄 Зависимости по уровням
> ```
> shared → modules → components → app
> shared/ может использоваться везде
> modules/ имеют доступ к shared/ и components/
> components/ не знают о modules/
> app/ агрегирует всё и связывает слои через маршрутизацию
> ```
